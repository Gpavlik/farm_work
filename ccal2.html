<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>–ö–∞–ª–µ–Ω–¥–∞—Ä –∑–∞–¥–∞—á</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@700&family=Roboto:wght@400;500;700;900&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/modern-normalize/1.1.0/modern-normalize.css"
    integrity="sha512-Y0MM+V6ymRKN2zStTqzQ227DWhhp4Mzdo6gnlRnuaNCbc+YN/ZH0sBCLTM4M0oSy9c9VKiCvd4Jk44aCLrNS5Q=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="./css/main.css" />
  <link rel="stylesheet" href="./css/styles.css">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    
  <style>
    main {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      margin-top: 0px;
      padding: 0px;
      opacity: 1;
    transform: translateY(40px);
    transition: all 2s ease-out;
    
    }
    main.loaded {
  animation: breathe 2s ease-out;
  }

@keyframes breathe {
  0% { transform: scale(0.9) translateY(40px); opacity: 0; }
  50% { transform: scale(1.05) translateY(-10px); opacity: 0.8; }
  100% { transform: scale(1) translateY(0); opacity: 1; }
}

.calendar-container {
  max-width: 1200px;
  margin: auto;
  position: relative;
  overflow: hidden;
      padding: 10px;
    }

    #calendarBackground {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-size: cover;
  background-position: center;
  opacity: 0.9;
  z-index: 0;
  transition: opacity 1s ease-in-out, background-image 1s ease-in-out;
}

#calendarBackground.loaded {
  opacity: 0.9;
}
    #calendar {
      position: relative;
      z-index: 1;
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 8px;
    }

    .calendar-header {
      text-align: center;
      margin-bottom: 10px;
      position: relative;
      z-index: 2;
    }

    .weekday {
      text-align: center;
      font-weight: bold;
      padding: 5px;
      background: #e5fdd1;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    .day {
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 10px;
      padding: 5px;
      min-height: 150px;
      cursor: pointer;
      transition: box-shadow 0.3s ease;
      opacity: 0.8;
    }

    .day:hover {
      box-shadow: 0 0 5px 5px #ffc0cbce;
    }

    .day strong {
      display: block;
      margin-bottom: 5px;
    }

    .day.weekend {
      background-color: #ffe5e5;
    }

    .day.has-tasks {
      background-color: #dbeafe;
    }

    .day.all-done {
      background-color: #d1e7dd;
    }

    .task {
      font-size: 12px;
      margin: 3px 0;
      background: #d1ecf1;
      padding: 2px 4px;
      border-radius: 3px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .task-text {
      flex-grow: 1;
      margin-right: 5px;
    }

    .task-text.done {
      text-decoration: line-through;
      color: gray;
    }

    button {
      background: #25a72b;
      color: white;
      border: 1px solid #ccc;
      padding: 2px 5px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
      margin-top: 5px;
    }

    button:hover {
      background: #218a24;
    }

    button:active {
      outline: none;
      box-shadow: 0 0 0 3px #25a72b;
    }

    .modal {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 10;
    }

    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 5px;
      width: 350px;
    }

    .modal-content h3 {
      margin-top: 0;
    }

    input[type="text"] {
      width: 100%;
      margin-top: 5px;
      padding: 5px;
      font-size: 14px;
      border-radius: 5px;
    }

    .filter {
      margin-top: 10px;
      text-align: center;
    }

    .edit-input {
      width: 100%;
      font-size: 12px;
      margin-top: 3px;
    }

    span {
      font-weight: bold;
      font-size: large;
      color: #25a72b;
    }
    .today-highlight {
  border: 2px solid #25a72b;
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(6px);
  border-radius: 8px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
  animation: pulse 1.5s infinite;
}

@keyframes pulse {
  0% { box-shadow: 0 0 0 5px rgba(15, 190, 30, 0.603); }
  70% { box-shadow: 0 0 0 10px rgba(15, 190, 30, 0); }
  100% { box-shadow: 0 0 0 3px rgba(15, 190, 30, 0); }
}

  </style>
<script type="module">
  // –Ü–º–ø–æ—Ä—Ç—É—î–º–æ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –º–æ–¥—É–ª—ñ
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-analytics.js";
  import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

  // –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyA2Gr8WYApA8STh3N4OUGOID9h9QCa6L5g",
    authDomain: "calendarstand.firebaseapp.com",
    projectId: "calendarstand",
    storageBucket: "calendarstand.firebasestorage.app",
    messagingSenderId: "435487300190",
    appId: "1:435487300190:web:4c161f304e54fb0aa5b2cf",
    measurementId: "G-ZKRJCVX1J4"
  };

  // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
  const db = getFirestore(app); // üî• –û—Å—å —Ç—É—Ç —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ Firestore

  // üì• –ó—á–∏—Ç—É–≤–∞–Ω–Ω—è –∑–∞–¥–∞—á
  async function loadTasks(year, month) {
    const key = `tasks-${year}-${month}`;
    const ref = doc(db, "calendar", key);
    const snapshot = await getDoc(ref);
    return snapshot.exists() ? snapshot.data() : {};
  }

  // üì§ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–∞–¥–∞—á
  async function saveTasks(year, month, tasks) {
    const key = `tasks-${year}-${month}`;
    const ref = doc(db, "calendar", key);
    await setDoc(ref, tasks);
  }

  // –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–∞–¥–∞—á—ñ
  loadTasks(currentYear, currentMonth).then(tasks => {
    console.log("–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –∑–∞–¥–∞—á—ñ:", tasks);
  });

  // –ó–±–µ—Ä–µ–≥—Ç–∏ –∑–∞–¥–∞—á—ñ
  const newTasks = {
    "2025-08-20": {
      task: "–ó—É—Å—Ç—Ä—ñ—á –∑ –¥–∏–∑–∞–π–Ω–µ—Ä–æ–º",
      emotion: "–Ω–∞—Ç—Ö–Ω–µ–Ω–Ω—è",
      weather: "—Å–æ–Ω—è—á–Ω–æ",
      done: false
    }
  };
  saveTasks(currentYear, currentMonth, newTasks).then(() => {
    console.log("–ó–∞–¥–∞—á—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–æ!");
  });
</script>
<script src='./weather.js'></script>
</head>
<body>
  <header class="header">
    <div class="container header__container">
      <a class="logo" href="./index.html"><img src="./images/logo.svg" alt="logo" width="160"></a>
      <!--<ul class="nav">
        <li class="nav__referent"><a class="nav__link" href="./index.html">–ì–æ–ª–æ–≤–Ω–∞</a></li>
        <li class="nav__referent"><a class="nav__link nav__link--active" href="./portfolio.html">–ö—É—Ä—Å–∏</a></li>
        <li class="nav__referent"><a class="nav__link" href="https://pharmasco.com/contacts" target="_blank" rel="noopener noreferrer">–ö–æ–Ω—Ç–∞–∫—Ç–∏</a></li>
      </ul>-->
      <ul class="contacts">
        <li class="contacts__contact">
          <a class="contacts__contact-mail " href="mailto:contact@pharmasco.com">
            <svg class="contacts__contact-icon" width="20px" height="20px">
              <use href="./images/sprite.svg#icon-envelope"></use>
            </svg>contact@pharmasco.com</a>
          </a>
        </li>
       <li class="contacts__contact">
          <a class="contacts__contact-phone " href="tel:+38 (044) 537-08-04">
            <svg class="contacts__contact-icon" width="20px" height="20px">
              <use href="./images/sprite.svg#icon-phone"></use>
            </svg>+38 (044) 537-08-04</a>
            <a class="contacts__contact-phone" style="margin-top: 8px;" href="tel:+38 (067) 500-82-74">
            <svg class="contacts__contact-icon" width="20px" height="20px">
              <use href="./images/sprite.svg#icon-phone"></use>
            </svg>+38 (067) 500-82-74</a>
        </li>
      </ul>
    </div>
    <button class="mobile-menu-btn" type="button" data-menu-button>
      <svg class="mobile-menu-icon" width="24" height="16">
        <use class="mobile-menu-burger" href="./images/sprite.svg#24-menu"></use>
        <use class="mobile-menu-close" href="./images/sprite.svg#icon-X"></use>
      </svg>
    </button>
    <div class="mobile-menu" data-menu>
      <!--<ul class="mobile-menu-nav">
        <li class="mobile-menu-nav-item">
          <a class="link " href="./index.html">–ì–æ–ª–æ–≤–Ω–∞</a>
        </li>
        <li class="mobile-menu-nav-item">
          <a class="link current" href="./portfolio.html">–ö—É—Ä—Å–∏</a>
        </li>
        <li class="mobile-menu-nav-item">
          <a class="link" href="/contact">–ö–æ–Ω—Ç–∞–∫—Ç–∏</a>
        </li>
      </ul>-->
      <ul class="mobile-menu-contacts">
        <li class="contacts__contact">
          <a class="contacts__contact-phone " href="tel:+38 (044) 537-08-04">
            <svg class="contacts__contact-icon" width="20px" height="20px">
              <use href="./images/sprite.svg#icon-phone"></use>
            </svg>+38 (044) 537-08-04</a>
            <a class="contacts__contact-phone" style="margin-top: 8px;" href="tel:+38 (067) 500-82-74">
            <svg class="contacts__contact-icon" width="20px" height="20px">
              <use href="./images/sprite.svg#icon-phone"></use>
            </svg>+38 (067) 500-82-74</a>
        </li>
        <li class="mobile-menu-contacts-item">
          <a class="link" href="mailto:contact@pharmasco.com">contact@pharmasco.com</a>
        </li>
      </ul>
      <ul class="mobile-menu-socials">
        <li class="mobile-menu-socials-item">
          <a class="mobile-menu-socials-link link" href="https://www.instagram.com/pharmascocom/" target="_blank" rel="noopener noreferrer">Instagram</a>
        </li>
        <li class="mobile-menu-socials-item">
          <a class="mobile-menu-socials-link link" href="https://www.youtube.com/@Pharmasco" target="_blank" rel="noopener noreferrer">Youtube</a>
        </li>
        <li class="mobile-menu-socials-item">
          <a class="mobile-menu-socials-link link" href="https://www.facebook.com/Pharmasco/" target="_blank" rel="noopener noreferrer">Facebook</a>
        </li>
      </ul>
    </div>
  </header>
<main class="loaded">
  <div class="calendar-container">
    <div id="calendarBackground">
      <img id="bgPreloader" style="display: none;" />
    </div>

    <div class="calendar-header">
      <button onclick="changeMonth(-1)">‚Üê</button>
      <span id="monthLabel"></span>
      <button onclick="changeMonth(1)">‚Üí</button>
      <button class="btn" type="button" style="margin-left: 80%;">
        <a class="text__work" href="./index.html" style="text-decoration: none; font-size: smaller;">
          –ù–∞–∑–∞–¥
        </a>
      </button>
    </div>

    <div id="calendar">
      <!-- Weekday headers and days will be inserted here -->
    </div>
  </div>

  <div id="modal" class="modal">
    <div class="modal-content">
      <h3>–ó–∞–¥–∞—á—ñ –Ω–∞ <span id="modalDate"></span></h3>
      <div class="filter">
        <label>
          <input type="checkbox" id="hideDone" onchange="renderTaskList()"> –ü–æ–∫–∞–∑–∞—Ç–∏ –ª–∏—à–µ –Ω–µ–≤–∏–∫–æ–Ω–∞–Ω—ñ
        </label>
      </div>
      <div id="taskList"></div>
      <input type="text" id="taskInput" placeholder="–ù–æ–≤–∞ –∑–∞–¥–∞—á–∞">
      <button onclick="addTask()">–î–æ–¥–∞—Ç–∏</button>
      <button onclick="closeModal()">–ó–∞–∫—Ä–∏—Ç–∏</button>
    </div>
  </div>
<footer class="footer">
    <div class="container">
      <div class="find-us">
        <div class="find">
          <a class="logo footer__logo" href="/"><img src="./images/logo.svg" alt="logo" width="160"></a>
          <ul class="contacts contacts--footer">
            <li class="contacts__contact contacts__contact--footer">
              <address class="contacts__post"><p>–£–∫—Ä–∞—ó–Ω–∞, –ö–∏—ó–≤—Å—å–∫–∞ –æ–±–ª.,</p> <p>–º. –í–∏—à–≥–æ—Ä–æ–¥,</p> <p>–≤—É–ª. –®–æ–ª—É–¥–µ–Ω–∫–∞, 15–≥</p></address>
            </li>
            <li class="contacts__contact contacts__contact--footer">
              <a class="contacts__contact-mail contacts__contact-mail--footer"
                href="mailto:contact@pharmasco.com">contact@pharmasco.com</a>
            </li>
            <li class="contacts__contact contacts__contact--footer">
              <a class="contacts__contact-phone contacts__contact-phone--footer" href="tel:+38 (044) 537-08-04">+38 (044) 537-08-04</a>
              <a class="contacts__contact-phone contacts__contact-phone--footer" href="tel:+38 (067) 500-82-74">+38 (067) 500-82-74</a>
            </li>
          </ul>
        </div>
        <div class="social social--footer">
          <h2 class="social__title">–ø—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å</h2>
          <ul class="social__list social__list--footer">
            <li class="social__item social__item--footer">
              <a class="social__link social__link--footer link" href="https://www.instagram.com/pharmascocom/" target="_blank" rel="noopener noreferrer"
                aria-label="–∏–Ω—Å—Ç–∞–≥—Ä–∞–º –∏–∫–æ–Ω–∫–∞">
                <svg class="social__icon social__icon--footer" width="20px" height="20px">
                  <use href="./images/sprite.svg#icon-instagram"></use>
                </svg></a>
            </li>
            <li class="social__item social__item--footer">
              <a class="social__link social__link--footer link" href="https://www.youtube.com/@Pharmasco" target="_blank" rel="noopener noreferrer"
                aria-label="—Ç–≤–∏—Ç—Ç–µ—Ä –∏–∫–æ–Ω–∫–∞">
                <svg class="social__icon social__icon--footer" width="20px" height="20px">
                  <use href="./images/uoytube.svg"></use>
                </svg></a>
            </li>
            <li class="social__item social__item--footer">
              <a class="social__link social__link--footer link" href="https://www.facebook.com/Pharmasco/" target="_blank" rel="noopener noreferrer"
                aria-label="—Ñ–µ–π—Å–±—É–∫ –∏–∫–æ–Ω–∫–∞">
                <svg class="social__icon social__icon--footer" width="20px" height="20px">
                  <use href="./images/sprite.svg#icon-facebook"></use>
                </svg></a> 
            </li>       
          </ul>
        </div>
        <div class="spam">
          <h2 class="spam__title" style="line-height: 2;">–¢–û–í ¬´–ù–í–ö ¬´–§–∞—Ä–º–∞—Å–∫–æ¬ª ‚Äì –ø—Ä–æ–≤—ñ–¥–Ω–∏–π –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫ –∑–∞—Å–æ–±—ñ–≤ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –¥–ª—è —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏—Ö –∑–∞–∫–ª–∞–¥—ñ–≤ –æ—Ö–æ—Ä–æ–Ω–∏ –∑–¥–æ—Ä–æ–≤‚Äô—è, –ª—ñ–∫–∞—Ä—ñ–≤ —Ç–∞ –ø–∞—Ü—ñ—î–Ω—Ç—ñ–≤.</h2>
          <!--<form class="spam__form">
            <label class="spam__label">
              <input class="spam__input" type="email" name="email" placeholder="E-mail" />
            </label>
            <button class="btn btn--spam" type="submit">–ü—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è<a class="spam-link link" href="" target="_blank"
                rel="noopener noreferrer" aria-label="–∏–Ω—Å—Ç–∞–≥—Ä–∞–º –∏–∫–æ–Ω–∫–∞">
                <svg class="spam__icon" width="24px" height="24px">
                  <use href="./images/sprite.svg#icon-send"></use>
                </svg></a></button>
          </form>-->
        </div>
      </div>
    </div>
        <p id="currentUser" style="font-size: smaller; color: #666; text-align: center;"></p>
  </footer>
  <script src="theme-toggle.js"></script>
  <script>
   let currentYear = new Date().getFullYear();
let currentMonth = new Date().getMonth();
let tasks = {};
let selectedDay = null;

const monthNames = [
  "–°—ñ—á–µ–Ω—å", "–õ—é—Ç–∏–π", "–ë–µ—Ä–µ–∑–µ–Ω—å", "–ö–≤—ñ—Ç–µ–Ω—å", "–¢—Ä–∞–≤–µ–Ω—å", "–ß–µ—Ä–≤–µ–Ω—å",
  "–õ–∏–ø–µ–Ω—å", "–°–µ—Ä–ø–µ–Ω—å", "–í–µ—Ä–µ—Å–µ–Ω—å", "–ñ–æ–≤—Ç–µ–Ω—å", "–õ–∏—Å—Ç–æ–ø–∞–¥", "–ì—Ä—É–¥–µ–Ω—å"
];

const weekdays = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–ù–¥"];

const backgroundKeywords = [
  "nature", "forest", "sunrise", "flowers", "mountains", "sky", "beach", "fog", "leaves", "snow"
];

let carouselIndex = 0;
let carouselInterval;
let carouselRunning = true;
let previousBackgroundUrl = "";

function loadTasks() {
  const key = `tasks-${currentYear}-${currentMonth}`;
  tasks = JSON.parse(localStorage.getItem(key)) || {};
}

function saveTasks() {
  const key = `tasks-${currentYear}-${currentMonth}`;
  localStorage.setItem(key, JSON.stringify(tasks));
}

function setRandomBackground(month) {
  const keywords = [
    "snow", "love", "spring", "flowers", "green", "sun", "beach",
    "forest", "leaves", "pumpkin", "fog", "christmas"
  ];
  const query = keywords[month] || "nature";
  const uniqueSig = `${currentYear}${month}${Date.now()}`;
  const requestUrl = `https://source.unsplash.com/1600x900/?${query}&sig=${uniqueSig}`;
  const fallbackUrl = `https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1600&q=80`;

  const bg = document.getElementById('calendarBackground');
  if (!bg) return;

  bg.classList.remove('loaded');

  fetch(requestUrl)
    .then(response => {
      bg.style.backgroundImage = `url('${response.url}')`;
      setTimeout(() => bg.classList.add('loaded'), 100);
    })
    .catch(error => {
      console.error("–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–æ–Ω—É:", error);
      bg.style.backgroundImage = `url('${fallbackUrl}')`;
      setTimeout(() => bg.classList.add('loaded'), 100);
    });
}

const fallbackImages = [
  "https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1600&q=80",
  "https://images.unsplash.com/photo-1503264116251-35a269479413?auto=format&fit=crop&w=1600&q=80",
  "https://images.unsplash.com/photo-1516117172878-fd2c41f4a759?auto=format&fit=crop&w=1600&q=80",
  "https://images.unsplash.com/photo-1523413651479-597eb2da0ad6?auto=format&fit=crop&w=1600&q=80",
  "https://images.unsplash.com/photo-1507149833265-60c372daea22?auto=format&fit=crop&w=1600&q=80",
  "https://images.unsplash.com/photo-1519985176271-adb1088fa94c?auto=format&fit=crop&w=1600&q=80",
  "https://images.unsplash.com/photo-1503264116251-35a269479413?auto=format&fit=crop&w=1600&q=80",
  "https://images.unsplash.com/photo-1518837695005-2083093ee35b?auto=format&fit=crop&w=1600&q=80",
  "https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1600&q=80",
  "https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?auto=format&fit=crop&w=1600&q=80",
  "https://images.unsplash.com/photo-1506748686214-e9df14d4d9d0?auto=format&fit=crop&w=1600&q=80",
  "https://images.unsplash.com/photo-1501854140801-50d01698950b?auto=format&fit=crop&w=1600&q=80",
  "https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=1600&q=80",
  "https://images.unsplash.com/photo-1593642634367-d91a135587b5?auto=format&fit=crop&w=1600&q=80"
];

function updateBackgroundManually() {
  const bg = document.getElementById('calendarBackground');
  if (!bg) return;

  const keyword = backgroundKeywords[carouselIndex % backgroundKeywords.length];
  const uniqueSig = `${Date.now()}-${carouselIndex}`;
  const requestUrl = `https://source.unsplash.com/1600x900/?${keyword}&sig=${uniqueSig}`;
  const fallbackUrl = fallbackImages[carouselIndex % fallbackImages.length];

  const img = new Image();
  img.onload = () => {
    bg.style.backgroundImage = `url('${requestUrl}')`;
    bg.classList.add('loaded');
  };
  img.onerror = () => {
    console.warn("Unsplash –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–≤. –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ fallback.");
    bg.style.backgroundImage = `url('${fallbackUrl}')`;
    bg.classList.add('loaded');
  };
  img.src = requestUrl;

  carouselIndex++;
}



function startBackgroundCarousel() {
  updateBackgroundManually(); // –ø–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫
  carouselInterval = setInterval(updateBackgroundManually, 10000);
}

function toggleCarousel() {
  if (carouselRunning) {
    clearInterval(carouselInterval);
    carouselRunning = false;
  } else {
    startBackgroundCarousel();
    carouselRunning = true;
  }
}

function generateCalendar(year, month) {
  setRandomBackground(month);

  document.getElementById('monthLabel').textContent = `${monthNames[month]} ${year}`;
  const calendar = document.getElementById('calendar');
  calendar.innerHTML = '';

  weekdays.forEach(day => {
    const header = document.createElement('div');
    header.className = 'weekday';
    header.textContent = day;
    calendar.appendChild(header);
  });

  const firstDay = new Date(year, month, 1).getDay();
  const offset = (firstDay + 6) % 7;
  const daysInMonth = new Date(year, month + 1, 0).getDate();

  for (let i = 0; i < offset; i++) {
    const empty = document.createElement('div');
    calendar.appendChild(empty);
  }

  for (let d = 1; d <= daysInMonth; d++) {
    const date = new Date(year, month, d);
    const dayOfWeek = date.getDay();

    const dayDiv = document.createElement('div');
    dayDiv.className = 'day';
    dayDiv.onclick = () => openModal(d);

    const isToday =
  d === new Date().getDate() &&
  month === new Date().getMonth() &&
  year === new Date().getFullYear();

if (isToday) {
  dayDiv.classList.add('today-highlight');
}


    if (dayOfWeek === 0 || dayOfWeek === 6) {
      dayDiv.classList.add('weekend');
    }

    let innerHTML = `<strong>${d}</strong>`;

    if (tasks[d]) {
      const allDone = tasks[d].every(task => task.startsWith('‚úîÔ∏è'));
      const hasTasks = tasks[d].length > 0;

      if (allDone) {
        dayDiv.classList.add('all-done');
      } else if (hasTasks) {
        dayDiv.classList.add('has-tasks');
      }

      tasks[d].slice(0, 2).forEach(task => {
        const isDone = task.startsWith('‚úîÔ∏è');
        const taskClass = isDone ? 'task-text done' : 'task-text';
        innerHTML += `<div class="task"><span class="${taskClass}">${task}</span></div>`;
      });

      if (tasks[d].length > 2) {
        innerHTML += `<div style="font-size:10px; color:gray;">+${tasks[d].length - 2} —â–µ</div>`;
      }
    }

    dayDiv.innerHTML = innerHTML;
    calendar.appendChild(dayDiv);
  }
}

function openModal(day) {
  selectedDay = day;
  document.getElementById('modalDate').textContent = `${day} ${monthNames[currentMonth]} ${currentYear}`;
  document.getElementById('taskInput').value = '';
  document.getElementById('hideDone').checked = false;
  renderTaskList();
  document.getElementById('modal').style.display = 'flex';
  clearInterval(carouselInterval);
  carouselRunning = false;
}

function closeModal() {
  document.getElementById('modal').style.display = 'none';
  startBackgroundCarousel();
  carouselRunning = true;
}

function renderTaskList() {
  const container = document.getElementById('taskList');
  container.innerHTML = '';
  const hideDone = document.getElementById('hideDone').checked;

  if (tasks[selectedDay]) {
    tasks[selectedDay].forEach((taskText, index) => {
      const isDone = taskText.startsWith('‚úîÔ∏è');
      if (hideDone && isDone) return;

      const taskEl = document.createElement('div');
      taskEl.className = 'task';

      const taskClass = isDone ? 'task-text done' : 'task-text';

      taskEl.innerHTML = `
        <span class="${taskClass}" ondblclick="editTask(${selectedDay}, ${index})">${taskText}</span>
        <button onclick="markDone(${selectedDay}, ${index})">‚úÖ</button>
        <button onclick="cancelTask(${selectedDay}, ${index})">‚ùå</button>
      `;
      container.appendChild(taskEl);
    });
  }
}

function addTask() {
  const input = document.getElementById('taskInput');
  const text = input.value.trim();
  if (!text) return;

  if (!tasks[selectedDay]) tasks[selectedDay] = [];
  tasks[selectedDay].push(text);
  input.value = '';
  saveTasks();
  renderTaskList();
  generateCalendar(currentYear, currentMonth);
}

function markDone(day, index) {
  const taskText = tasks[day][index];
  if (!taskText.startsWith('‚úîÔ∏è')) {
    tasks[day][index] = `‚úîÔ∏è ${taskText}`;
    saveTasks();
    renderTaskList();
    generateCalendar(currentYear, currentMonth);
  }
}

function cancelTask(day, index) {
  tasks[day].splice(index, 1);
  if (tasks[day].length === 0) delete tasks[day];
  saveTasks();
  renderTaskList();
  generateCalendar(currentYear, currentMonth);
}

function editTask(day, index) {
  const container = document.getElementById('taskList');
  const taskText = tasks[day][index].replace(/^‚úîÔ∏è /, '');
  const input = document.createElement('input');
  input.type = 'text';
  input.value = taskText;
  input.className = 'edit-input';

  input.onkeydown = (e) => {
    if (e.key === 'Enter') {
      const newText = input.value.trim();
      if (newText) {
        const prefix = isDone ? '‚úîÔ∏è ' : '';
        tasks[day][index] = prefix + newText;
        saveTasks();
        renderTaskList();
        generateCalendar(currentYear, currentMonth);
      }
    } else if (e.key === 'Escape') {
      renderTaskList(); // —Å–∫–∞—Å—É–≤–∞—Ç–∏ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
    }
  };

  const taskEl = container.children[index];
  const span = taskEl.querySelector('span');
  span.replaceWith(input);
  input.focus();
}

function changeMonth(offset) {
  currentMonth += offset;
  if (currentMonth < 0) {
    currentMonth = 11;
    currentYear--;
  } else if (currentMonth > 11) {
    currentMonth = 0;
    currentYear++;
  }
  loadTasks();
  generateCalendar(currentYear, currentMonth);
}

// –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
document.addEventListener('DOMContentLoaded', () => {
  loadTasks();
  generateCalendar(currentYear, currentMonth);
  startBackgroundCarousel();
});
document.getElementById('nextBackgroundBtn').addEventListener('click', () => {
  updateBackgroundManually();
});

    </script>

    </body>
</html>
