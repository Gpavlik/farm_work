<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>–î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ä–æ–±–æ—Ç–∏ —Ä–µ–≥—ñ–æ–Ω–∞–ª—å–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞</title>
  <style>
    body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }
    h1 { text-align: center; margin-bottom: 30px; }
    .group-block { margin-bottom: 40px; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 0 5px rgba(0,0,0,0.1); }
    .criterion { margin-bottom: 20px; }
    .criterion label { font-weight: bold; display: block; margin-bottom: 5px; }
    .criterion p { margin: 5px 0; font-size: 0.95em; color: #555; }
    .criterion select { width: 100%; padding: 5px; }
    #results, #styleBlock, #recommendationBlock {
      margin-top: 30px;
      padding: 15px;
      border-radius: 8px;
    }
    #results { background-color: #e0ffe0; border: 1px solid #0c0; }
    #styleBlock { background-color: #eef; border: 1px solid #77c; }
    #recommendationBlock { background-color: #fff8e1; border: 1px solid #ffc107; }
    button { padding: 10px 20px; font-size: 16px; background-color: #007acc; color: white; border: none; border-radius: 5px; cursor: pointer; }
    button:hover { background-color: #005fa3; }
  </style>
</head>
<body>

  <h1>üßæ –û—Ü—ñ–Ω–∫–∞ —Ç–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å—Ç–∏–ª—é –†–ú</h1>

  <div id="formContainer">
    <!-- –°—é–¥–∏ JavaScript –¥–∏–Ω–∞–º—ñ—á–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å –≤—Å—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—ó -->
  </div>

  <button onclick="calculateEvaluation()">üîç –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏</button>

  <div id="results"></div>
  <div id="styleBlock"></div>
  <div id="recommendationBlock"></div>
  <div style="text-align: center; margin-top: 20px;">
    <p>–ü—ñ—Å–ª—è –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –≤—Å—ñ—Ö –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É "üîç –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏" –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤.</p>
  </div>
  <script src="criteria.js"></script>
  <script>
   document.addEventListener("DOMContentLoaded", () => {
  const container = document.getElementById("formContainer");

  const grouped = {};
  evaluationCriteria.forEach(item => {
    if (!grouped[item.group]) grouped[item.group] = [];
    grouped[item.group].push(item);
  });

  for (const groupName in grouped) {
    const groupBlock = document.createElement("div");
    groupBlock.className = "group-block";
    const title = document.createElement("h2");
    title.textContent = `üîπ ${groupName}`;
    groupBlock.appendChild(title);

    grouped[groupName].forEach(crit => {
      const div = document.createElement("div");
      div.className = "criterion";

      const label = document.createElement("label");
      label.htmlFor = crit.id;
      label.textContent = crit.title;

      const desc = document.createElement("p");
      desc.textContent = crit.description;

      const select = document.createElement("select");
      select.id = crit.id;
      select.innerHTML = `<option value="">–ù–µ –æ—Ü—ñ–Ω–µ–Ω–æ</option>` +
        Object.entries(crit.levels).map(
          ([key, val]) => `<option value="${key}">${key} ‚Äì ${val}</option>`
        ).join("");

      div.appendChild(label);
      div.appendChild(desc);
      div.appendChild(select);
      groupBlock.appendChild(div);
    });

    container.appendChild(groupBlock);
  }

  // –°—Ç–≤–æ—Ä—é—î–º–æ –∫–Ω–æ–ø–∫—É –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è
  const copyBtn = document.createElement("button");
  copyBtn.textContent = "üìã –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó";
  copyBtn.onclick = copyRecommendations;
  document.body.appendChild(copyBtn);
});

function determineStyle() {
  const avg = arr => arr.reduce((a, b) => a + b, 0) / arr.length;
  const getScores = ids => ids.map(id => parseInt(document.getElementById(id)?.value) || 0);

  const groups = {
    control: ['prep_1', 'prep_2', 'correction_1', 'visit_1'],
    coaching: ['prep_3', 'trust_1', 'correction_2', 'practice_1'],
    support: ['trust_1', 'trust_2', 'practice_2'],
    delegation: ['prep_4', 'correction_3', 'post_2']
  };

  const averages = {};
  for (const key in groups) {
    averages[key] = avg(getScores(groups[key]));
  }

  const maxKey = Object.entries(averages).sort((a, b) => b[1] - a[1])[0][0];
  const styleMap = {
    control: "–î–∏—Ä–µ–∫—Ç–∏–≤–Ω–∏–π",
    coaching: "–†–æ–∑–≤–∏–≤–∞—é—á–∏–π",
    support: "–ü—ñ–¥—Ç—Ä–∏–º—É—é—á–∏–π",
    delegation: "–î–µ–ª–µ–≥—É—é—á–∏–π"
  };

  return styleMap[maxKey] || "–ù–µ–≤–∏–∑–Ω–∞—á–µ–Ω–æ";
}

function calculateEvaluation() {
  let total = 0, count = 0;
  const lowCriteria = [];

  evaluationCriteria.forEach(crit => {
    const val = parseInt(document.getElementById(crit.id).value);
    if (!isNaN(val)) {
      total += val;
      count++;
      if (val > 0 && val < 3) lowCriteria.push(crit);
    }
  });

  const avg = count ? (total / count).toFixed(2) : "‚Äî";
  document.getElementById("results").innerHTML = `üìä –ó–∞–≥–∞–ª—å–Ω–∞ –æ—Ü—ñ–Ω–∫–∞: <strong>${avg} / 5</strong>`;

  const style = determineStyle();
  document.getElementById("styleBlock").innerHTML = `üß≠ –°—Ç–∏–ª—å —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è: <strong>${style}</strong>`;

  const recMap = {
    "–î–∏—Ä–µ–∫—Ç–∏–≤–Ω–∏–π": "–ó–≤–µ—Ä–Ω–∏ —É–≤–∞–≥—É –Ω–∞ —Ä–æ–∑–≤–∏—Ç–æ–∫ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ—Å—Ç—ñ —É –¢–ü–†–ö —Ç–∞ –º'—è–∫—à–∏–π –µ–º–æ—Ü—ñ–π–Ω–∏–π –∫–æ–Ω—Ç–∞–∫—Ç.",
    "–†–æ–∑–≤–∏–≤–∞—é—á–∏–π": "–°–∏–ª—å–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–∞ ‚Äî –Ω–∞–≤—á–∞–Ω–Ω—è. –í–∞–∂–ª–∏–≤–æ –Ω–µ –∑–∞–±—É–≤–∞—Ç–∏ –ø—Ä–æ –∫–æ–Ω—Ç—Ä–æ–ª—å —ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.",
    "–ü—ñ–¥—Ç—Ä–∏–º—É—é—á–∏–π": "–î–æ–±—Ä–µ –ø—Ä–∞—Ü—é—î—à –∑ –¥–æ–≤—ñ—Ä–æ—é. –î–æ–¥–∞–π –±—ñ–ª—å—à–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ –Ω–∞–≤–∏—á–æ–∫.",
    "–î–µ–ª–µ–≥—É—é—á–∏–π": "–í–∏—Å–æ–∫–∏–π —Ä—ñ–≤–µ–Ω—å –∞–≤—Ç–æ–Ω–æ–º—ñ—ó. –ü–µ—Ä–µ–≤—ñ—Ä—è–π, —á–∏ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ –∑–≤‚Äô—è–∑–∫—É.",
    "–ù–µ–≤–∏–∑–Ω–∞—á–µ–Ω–æ": "–û—Ü—ñ–Ω–∫–∞ –∑–º—ñ—à–∞–Ω–∞ ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –ø—Ä–æ–π—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω—É –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫—É –∞–±–æ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è."
  };

  let output = `<p><strong>üìå –ó–∞–≥–∞–ª—å–Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:</strong> ${recMap[style] || "‚Äî"}</p>`;

  if (lowCriteria.length) {
    output += `<strong>üîß –ö—Ä–∏—Ç–µ—Ä—ñ—ó –∑ –Ω–∏–∑—å–∫–æ—é –æ—Ü—ñ–Ω–∫–æ—é (–º–µ–Ω—à–µ 3):</strong><ul>`;
    lowCriteria.forEach(item => {
      const lvl = item.levels["1"] || item.levels["2"];
      output += `<li><strong>${item.title}</strong> ‚Äî ${lvl}</li>`;
    });
    output += `</ul>`;
  } else {
    output += `<p>‚úÖ –£—Å—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—ó –æ—Ü—ñ–Ω–µ–Ω—ñ –Ω–∞ —Ä—ñ–≤–Ω—ñ 3 —ñ –≤–∏—â–µ.</p>`;
  }

  document.getElementById("recommendationBlock").innerHTML = output;
}

// üìã –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç—É —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π
function copyRecommendations() {
  const output = document.getElementById("recommendationBlock").innerText;
  navigator.clipboard.writeText(output).then(() => {
    alert("–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ –¥–æ –±—É—Ñ–µ—Ä–∞ üìù");
  }).catch(() => {
    alert("–ù–µ –≤–¥–∞–ª–æ—Å—è —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç üòî");
  });
}

</script>

</body>
</html>
